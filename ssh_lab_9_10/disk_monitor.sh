
REMOTE_USER="username"        # Имя пользователя на удаленном сервере
REMOTE_HOST="remote_host"     # Адрес удаленного сервера
THRESHOLD=80                   # Пороговое значение использования дискового пространства в процентах
EMAIL="your_email@example.com" # Электронная почта для уведомлений

# 1. Подключаемся к удалённому серверу и проверяем процент использования дискового пространства
USAGE=$(ssh ${REMOTE_USER}@${REMOTE_HOST} "df -h / | awk 'NR==2 {print \\$5}' | sed 's/%//g'")

# 2. Проверяем, превышает ли использование порог
if [ "$USAGE" -gt "$THRESHOLD" ]; then
    # 3. Отправляем уведомление по электронной почте
    echo "Внимание! Использование дискового пространства на сервере ${REMOTE_HOST} превышает ${THRESHOLD}%. Текущее использование: ${USAGE}%." | mail -s "Уведомление о дисковом пространстве" ${EMAIL}
fi

echo "Проверка завершена. Текущее использование: ${USAGE}%."
